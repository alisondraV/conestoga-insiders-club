@page "/profile"
@using ConestogaInsidersClub.Data.Models;
@using ConestogaInsidersClub.Data.DataAccess;

@inject IUserService db;

<h1>Profile</h1>
<br />

@if (authenticationState != null)
{
    <table>
        <tr>
            <td width="100px"><b>Username:</b></td>
            <td><span id="UserName">@authenticationState.User.Identity.Name</span></td>
        </tr>
        <tr>
            <td width="100px"><b>Full Name:</b></td>
            <td><span id="Full_Name">@user.FirstName @user.LastName</span></td>
        </tr>
        <tr>
            <td width="100px"><b>Email:</b></td>
            <td><span id="Email">@user.Email</span></td>
        </tr>
    </table>
}

@code {
    [CascadingParameter]
    private Task<AuthenticationState> AuthenticationState { get; set; }
    private AuthenticationState authenticationState;
    private ApplicationUser user;

    protected override async Task OnInitializedAsync()
    {
        authenticationState = await AuthenticationState;
        user = db.GetUser(authenticationState.User.Identity.Name);
    }
}
